// ==UserScript==
// @name        IbaraSeisanPasta
// @namespace   Pejuta
// @description イバラシティの生産をパスタする
// @include     http://lisge.com/ib/act_trade.php
// @version     1.1.3
// @grant       none
// ==/UserScript==
var Program,__extends=this&&this.__extends||function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(t){var a=window.jQuery;function u(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]}function s(t){var e=parseInt(t);return t!==e+""?null:e}var p,e,o=function(n){function t(t){var e=n.call(this,t)||this;return e.name="CustomError",e}return __extends(t,n),t.prototype.toString=function(){var t="#"+this.name+": "+this.message;for(var e in this)"name"!==e&&(t+="\n"+e+": "+this[e].toString());return t},t}(Error),n=function(){function t(t){this.names_=null,this.optionValues_=null,this.Select=t}return Object.defineProperty(t.prototype,"Select",{set:function(t){var e=a(t).find("option");this.names_=e.map(function(t,e){return e.textContent}).get(),this.optionValues_=e.map(function(t,e){return e.value}).get()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Names",{get:function(){if(!this.names_)throw new o("配列names_が初期化されていません。this.Selectが指定されていないことが原因のようです。");return this.names_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Values",{get:function(){if(!this.optionValues_)throw new o("配列optionValues_が初期化されていません。this.Selectが指定されていないことが原因のようです。");return this.optionValues_},enumerable:!0,configurable:!0}),t.prototype.Get=function(t){return{Name:this.Names[t],Value:this.Values[t]}},t.prototype.GetFromValue=function(t){var e=this.Values.indexOf(t);if(-1===e)throw new o("入力値 "+t+" に一致する値がSelect > Option.valueの一覧にありませんでした。");return this.Get(e)},t.prototype.GetFromName=function(t){var e=this.Names.indexOf(t);if(-1===e)throw new o("入力値 "+t+" に一致する値がSelect > Option.textContentの一覧にありませんでした。");return this.Get(e)},t}();(e=p||(p={}))[e.None=0]="None",e[e.Equipment=1]="Equipment",e[e.Enchantment=2]="Enchantment",e[e.Composition=3]="Composition",e[e.Food=4]="Food";var m=function(){function n(t,e){void 0===e&&(e=null),this.prod_=e,this.ProductionNumber=t,this.enoInput_=n.$EnoInput(t)[0],this.productionTypeSelect_=n.$ProductionTypeSelect(t)[0]}return Object.defineProperty(n.prototype,"Production",{get:function(){return this.prod_},enumerable:!0,configurable:!0}),n.$EnoInput=function(t){return a("input[name='dt_seieno"+t+"']")},n.$ProductionTypeSelect=function(t){return a("select[name='dt_seisan"+t+"']")},n.ExtractProductionType=function(t){return n.ProductionTypeOptionValues.indexOf(n.$ProductionTypeSelect(t).val())},n.ExtractProductionNumber=function(t){var e=t.getAttribute("name");if(null===e)throw new o("Elementに名前が存在しません。不正なElementが入力されたようです。");var n=/dt_\D+(\d+)/.exec(e);if(!n)throw new o("Elementの名前最後部に数字が存在しません。不正なElementが入力されたようです。");var r=parseInt(n[1]);if(isNaN(r))throw new o("生産枠番号が正常に取得できませんでした。");return r},n.ExtractAndValidateENo=function(t){var e=this.$EnoInput(t).val(),n=s(e);if(""!==e&&null===n)throw new c(e);return n},n.ParseAndValidateItemNumber=function(t){var e=s(t);if(""!==t&&null===e)throw new d(t);return e},n.ValidateItemNameLength=function(t){if(0===t.length)return null;if(t.length>this.MaxItemNameChars)throw new l(t);return t},n.IsInvalidInputValueError=function(t){return"InvalidENoError"===t.name||"InvalidItemNumberError"===t.name||"ItemNameTooLongError"===t.name},n.ExtractProduction=function(t){var e=this.ExtractAndValidateENo(t);if(null===e)return null;var n=this.ExtractProductionType(t);return null===n||n===p.None?null:{ENo:e,ProductionType:n}},n.prototype.ExportProduction=function(){this.Production&&(this.enoInput_.value=this.Production.ENo+"",this.productionTypeSelect_.value=n.ProductionTypeOptionValues[this.Production.ProductionType])},n.prototype.Bind=function(t,e,n){var r=this,o=a(this.enoInput_).add(this.productionTypeSelect_);n&&(o=o.add(n)),o.on(t,function(){e(r)})},n.prototype.Unbind=function(t,e){var n=a(this.enoInput_).add(this.productionTypeSelect_);e&&(n=n.add(e)),n.unbind(t)},n.$ProductionTypeOptions=n.$ProductionTypeSelect(1).find("option"),n.ProductionTypeOptionValues=n.$ProductionTypeOptions.map(function(t,e){return e.value}).get(),n.MaxItemNameChars=16,n}(),r=function(){function t(t){if(this.ENo=t.ENo,this.ProductionType=t.ProductionType,this.ProductionType===p.None)throw new i}return t.TryParse=function(t,e){throw new o},t.MaxItemNameChars=16,t}(),i=function(n){function t(t){var e=n.call(this,t)||this;return e.name="ProductionTypeIsNotSetError",e}return __extends(t,n),t}(o),c=function(r){function t(t,e){var n=r.call(this,e)||this;return n.ENoText=t,n.name="InvalidENoError",n}return __extends(t,r),t}(o),d=function(r){function t(t,e){var n=r.call(this,e)||this;return n.ItemNumberText=t,n.name="InvalidItemNumberError",n}return __extends(t,r),t}(o),l=function(r){function t(t,e){var n=r.call(this,e)||this;return n.ItemName=t,n.name="ItemNameTooLongError",n}return __extends(t,r),t}(o),h=function(n){function t(t){var e=n.call(this,t)||this;return e.Category=t.Category,e}return __extends(t,n),t}(r),N=function(r){function o(t,e){void 0===e&&(e=null);var n=r.call(this,t,e)||this;return n.itemNum1Input_=o.$ItemNum1Input(t)[0],n.categorySelect_=o.$CategorySelect(t)[0],n.itemNameInput_=o.$ItemNameInput(t)[0],n.weaponRangeSelect_=o.$WeaponRangeSelect(t)[0],n}return __extends(o,r),Object.defineProperty(o.prototype,"Production",{get:function(){return this.prod_},enumerable:!0,configurable:!0}),o.$ItemNum1Input=function(t){return a("input[name='dt_sakuA"+t+"']")},o.$CategorySelect=function(t){return a("select[name='dt_sakuB"+t+"']")},o.$ItemNameInput=function(t){return a("input[name='dt_sakuC"+t+"']")},o.$WeaponRangeSelect=function(t){return a("select[name='dt_sakuD"+t+"']")},o.ExtractProduction=function(t){var e=m.ExtractProduction(t);if(!e||e.ProductionType!==p.Equipment)return null;var n=m.ParseAndValidateItemNumber(this.$ItemNum1Input(t).val());if(null===n)return null;var r=this.Categories.GetFromValue(this.$CategorySelect(t).val()),o=m.ValidateItemNameLength(this.$ItemNameInput(t).val());if(null===o)return null;var i=parseInt(this.$WeaponRangeSelect(t).val());return new I({ENo:e.ENo,ProductionType:p.Equipment,ItemNum1:n,Category:r,ItemName:o,WeaponRange:i})},o.UpdateNameCharsCounter=function(t){this.$ItemNameInput(t).trigger("keyup")},o.prototype.ImportProduction=function(){try{this.prod_=o.ExtractProduction(this.ProductionNumber)}catch(t){throw m.IsInvalidInputValueError(t)&&(this.prod_=null),t}},o.prototype.ExportProduction=function(){r.prototype.ExportProduction.call(this),this.Production&&(this.itemNum1Input_.value=this.Production.ItemNum1+"",this.itemNameInput_.value=this.Production.ItemName,this.categorySelect_.value=this.Production.Category.Value,this.weaponRangeSelect_.value=this.Production.WeaponRange+"",o.UpdateNameCharsCounter(this.ProductionNumber))},o.prototype.Bind=function(t,e){var n=a(this.itemNum1Input_).add(this.categorySelect_).add(this.itemNameInput_).add(this.weaponRangeSelect_);r.prototype.Bind.call(this,t,e,n)},o.prototype.Unbind=function(t){var e=a(this.itemNum1Input_).add(this.categorySelect_).add(this.itemNameInput_).add(this.weaponRangeSelect_);r.prototype.Unbind.call(this,t,e)},o.Categories=new n(o.$CategorySelect(1)[0]),o.ValidWeaponRanges=new n(o.$WeaponRangeSelect(1)[0]),o}(m),I=function(n){function t(t){var e=n.call(this,t)||this;return e.ItemNum1=t.ItemNum1,e.ItemName=t.ItemName,e.WeaponRange=t.WeaponRange,e}return __extends(t,n),t.TryParse=function(t,e){var n=this.parserRegExp1.exec(e)||this.parserRegExpOfficial.exec(e);if(!n)return null;void 0===n[5]?parseInt(N.ValidWeaponRanges.Values[0]):parseInt(n[5]);return new this({ENo:parseInt(n[1]),ProductionType:p.Equipment,ItemNum1:parseInt(n[2]),Category:N.Categories.GetFromName(n[3]),ItemName:n[4],WeaponRange:void 0===n[5]?1:parseInt(n[5])})},t.prototype.GeneratePasta=function(){return["[装備作製]ENo."+this.ENo,"ItemNo."+this.ItemNum1,this.Category.Name,this.ItemName,"武器なら射程"+this.WeaponRange].join("/")},t.parserRegExp1=new RegExp("^(?:[^\\/]??(?:装備)?作製[^\\/]?? ?)?(?:ENo\\.)?(\\d+)\\/(?:ItemNo\\.)?(\\d+)\\/("+N.Categories.Names.join("|")+")\\/(.{1,"+r.MaxItemNameChars+"}?)(?:\\/(?:武器なら)?射程("+N.ValidWeaponRanges.Values.join("|")+"))?$"),t.parserRegExpOfficial=new RegExp("^［装備作製］.*?\\((\\d+)\\) の所持する ItemNo.(\\d+)（.*?）から ("+N.Categories.Names.join("|")+") を作製　　└〈装備名〉(.{1,"+r.MaxItemNameChars+"}?)(?: 〈射程〉("+N.ValidWeaponRanges.Values.join("|")+"))?$"),t}(h),f=function(r){function o(t,e){void 0===e&&(e=null);var n=r.call(this,t,e)||this;return n.itemNum1Input_=o.$ItemNum1Input(t)[0],n.itemNum2Input_=o.$ItemNum2Input(t)[0],n}return __extends(o,r),Object.defineProperty(o.prototype,"Production",{get:function(){return this.prod_},enumerable:!0,configurable:!0}),o.$ItemNum1Input=function(t){return a("input[name='dt_hukaA"+t+"']")},o.$ItemNum2Input=function(t){return a("input[name='dt_hukaB"+t+"']")},o.ExtractProduction=function(t){var e=m.ExtractProduction(t);if(!e||e.ProductionType!==p.Enchantment)return null;var n=m.ParseAndValidateItemNumber(this.$ItemNum1Input(t).val()),r=m.ParseAndValidateItemNumber(this.$ItemNum2Input(t).val());return null===n||null===r?null:new g({ENo:e.ENo,ProductionType:p.Enchantment,ItemNum1:n,ItemNum2:r})},o.prototype.ImportProduction=function(){try{this.prod_=o.ExtractProduction(this.ProductionNumber)}catch(t){throw m.IsInvalidInputValueError(t)&&(this.prod_=null),t}},o.prototype.ExportProduction=function(){r.prototype.ExportProduction.call(this),this.Production&&(this.itemNum1Input_.value=this.Production.ItemNum1+"",this.itemNum2Input_.value=this.Production.ItemNum2+"")},o.prototype.Bind=function(t,e){var n=a(this.itemNum1Input_).add(this.itemNum2Input_);r.prototype.Bind.call(this,t,e,n)},o.prototype.Unbind=function(t){var e=a(this.itemNum1Input_).add(this.itemNum2Input_);r.prototype.Unbind.call(this,t,e)},o}(m),g=function(n){function t(t){var e=n.call(this,t)||this;return e.ItemNum1=t.ItemNum1,e.ItemNum2=t.ItemNum2,e}return __extends(t,n),t.TryParse=function(t,e){var n=this.parserRegExp1.exec(e)||this.parserRegExp2.exec(e)||this.parserRegExpOfficial.exec(e);return n?new this({ENo:parseInt(n[1]),ProductionType:p.Enchantment,ItemNum1:parseInt(n[2]),ItemNum2:parseInt(n[3])}):null},t.prototype.GeneratePasta=function(){return["[効果付加]ENo."+this.ENo,"ItemNo."+this.ItemNum1,"ItemNo."+this.ItemNum2].join("/")},t.parserRegExp1=/^[^\/]??(?:効果)?付加[^\/]?? ?(?:ENo\.)?(\d+)\/(?:ItemNo\.)?(\d+)\/(?:ItemNo\.)?(\d+)$/,t.parserRegExp2=/^(?:ENo\.)?(\d+)\/(?:ItemNo\.)?(\d+)\/(?:ItemNo\.)?(\d+)\/付加$/,t.parserRegExpOfficial=/^［効果付加］.*?\((\d+)\) の所持する ItemNo.(\d+)（.*?）に ItemNo.(\d+)（.*?）を付加$/,t}(r),y=function(r){function o(t,e){void 0===e&&(e=null);var n=r.call(this,t,e)||this;return n.itemNum1Input_=o.$ItemNum1Input(t)[0],n.itemNum2Input_=o.$ItemNum2Input(t)[0],n.methodSelect_=o.$CategorySelect(t)[0],n}return __extends(o,r),Object.defineProperty(o.prototype,"Production",{get:function(){return this.prod_},enumerable:!0,configurable:!0}),o.$ItemNum1Input=function(t){return a("input[name='dt_goseiA"+t+"']")},o.$ItemNum2Input=function(t){return a("input[name='dt_goseiB"+t+"']")},o.$CategorySelect=function(t){return a("select[name='dt_goseiC"+t+"']")},o.ExtractProduction=function(t){var e=m.ExtractProduction(t);if(!e||e.ProductionType!==p.Composition)return null;var n=m.ParseAndValidateItemNumber(this.$ItemNum1Input(t).val()),r=m.ParseAndValidateItemNumber(this.$ItemNum2Input(t).val());if(null===n||null===r)return null;var o=this.Categories.GetFromValue(this.$CategorySelect(t).val());return new E({ENo:e.ENo,ProductionType:p.Composition,ItemNum1:n,ItemNum2:r,Category:o})},o.prototype.ImportProduction=function(){try{this.prod_=o.ExtractProduction(this.ProductionNumber)}catch(t){throw m.IsInvalidInputValueError(t)&&(this.prod_=null),t}},o.prototype.ExportProduction=function(){r.prototype.ExportProduction.call(this),this.Production&&(this.itemNum1Input_.value=this.Production.ItemNum1+"",this.itemNum2Input_.value=this.Production.ItemNum2+"",this.methodSelect_.value=this.Production.Category.Value)},o.prototype.Bind=function(t,e){var n=a(this.itemNum1Input_).add(this.itemNum2Input_).add(this.methodSelect_);r.prototype.Bind.call(this,t,e,n)},o.prototype.Unbind=function(t){var e=a(this.itemNum1Input_).add(this.itemNum2Input_).add(this.methodSelect_);r.prototype.Unbind.call(this,t,e)},o.Categories=new n(o.$CategorySelect(1)[0]),o}(m),E=function(n){function t(t){var e=n.call(this,t)||this;return e.ItemNum1=t.ItemNum1,e.ItemNum2=t.ItemNum2,e}return __extends(t,n),t.TryParse=function(t,e){var n=this.parserRegExp1.exec(e)||this.parserRegExp2.exec(e)||this.parserRegExpOfficial.exec(e);if(!n)return null;var r=n[4]||y.Categories.Names[0];return new this({ENo:parseInt(n[1]),ProductionType:p.Composition,ItemNum1:parseInt(n[2]),ItemNum2:parseInt(n[3]),Category:y.Categories.GetFromName(r)})},t.prototype.GeneratePasta=function(){return["[合成]ENo."+this.ENo,"ItemNo."+this.ItemNum1,"ItemNo."+this.ItemNum2,this.Category.Name].join("/")},t.parserRegExp1=new RegExp("^[^\\/]??合成[^\\/]?? ?(?:ENo\\.)?(\\d+)\\/(?:ItemNo\\.)?(\\d+)\\/(?:ItemNo\\.)?(\\d+)(?:\\/("+y.Categories.Names.join("|")+"))?$"),t.parserRegExp2=new RegExp("^(?:ENo\\.)?(\\d+)\\/(?:ItemNo\\.)?(\\d+)\\/(?:ItemNo\\.)?(\\d+)\\/("+y.Categories.Names.join("|")+")$"),t.parserRegExpOfficial=new RegExp("^［(?:"+y.Categories.Names.join("|")+")］.*?\\((\\d+)\\) の所持する ItemNo.(\\d+)（.*?）に ItemNo.(\\d+)（.*?）を("+y.Categories.Names.join("|")+")$"),t}(h),P=function(r){function o(t,e){void 0===e&&(e=null);var n=r.call(this,t,e)||this;return n.itemNum1Input_=o.$ItemNum1Input(t)[0],n.categorySelect_=o.$CategorySelect(t)[0],n.itemNameInput_=o.$ItemNameInput(t)[0],n}return __extends(o,r),Object.defineProperty(o.prototype,"Production",{get:function(){return this.prod_},enumerable:!0,configurable:!0}),o.$ItemNum1Input=function(t){return a("input[name='dt_ryoriA"+t+"']")},o.$CategorySelect=function(t){return a("select[name='dt_ryoriB"+t+"']")},o.$ItemNameInput=function(t){return a("input[name='dt_ryoriC"+t+"']")},o.ExtractProduction=function(t){var e=m.ExtractProduction(t);if(!e||e.ProductionType!==p.Food)return null;var n=m.ParseAndValidateItemNumber(this.$ItemNum1Input(t).val());if(null===n)return null;var r=this.Categories.GetFromValue(this.$CategorySelect(t).val()),o=m.ValidateItemNameLength(this.$ItemNameInput(t).val());return null===o?null:new _({ENo:e.ENo,ProductionType:p.Food,ItemNum1:n,Category:r,ItemName:o})},o.UpdateNameCharsCounter=function(t){this.$ItemNameInput(t).trigger("keyup")},o.prototype.ImportProduction=function(){try{this.prod_=o.ExtractProduction(this.ProductionNumber)}catch(t){throw m.IsInvalidInputValueError(t)&&(this.prod_=null),t}},o.prototype.ExportProduction=function(){r.prototype.ExportProduction.call(this),this.Production&&(this.itemNum1Input_.value=this.Production.ItemNum1+"",this.itemNameInput_.value=this.Production.ItemName,this.categorySelect_.value=this.Production.Category.Value,o.UpdateNameCharsCounter(this.ProductionNumber))},o.prototype.Bind=function(t,e){var n=a(this.itemNum1Input_).add(this.categorySelect_).add(this.itemNameInput_);r.prototype.Bind.call(this,t,e,n)},o.prototype.Unbind=function(t){var e=a(this.itemNum1Input_).add(this.categorySelect_).add(this.itemNameInput_);r.prototype.Unbind.call(this,t,e)},o.Categories=new n(o.$CategorySelect(1)[0]),o}(m),_=function(n){function t(t){var e=n.call(this,t)||this;return e.ItemNum1=t.ItemNum1,e.ItemName=t.ItemName,e}return __extends(t,n),t.TryParse=function(t,e){var n=this.parserRegExp1.exec(e)||this.parserRegExpOfficial.exec(e);return n?new this({ENo:parseInt(n[1]),ProductionType:p.Food,ItemNum1:parseInt(n[2]),Category:P.Categories.GetFromName(n[3]),ItemName:n[4]}):null},t.prototype.GeneratePasta=function(){return["[料理]ENo."+this.ENo,"ItemNo."+this.ItemNum1,this.Category.Name,this.ItemName].join("/")},t.parserRegExp1=new RegExp("^(?:[^\\/]??料理[^\\/]?? ?)?(?:ENo\\.)?(\\d+)\\/(?:ItemNo\\.)?(\\d+)\\/("+P.Categories.Names.join("|")+")\\/(.{"+r.MinItemNameChars+","+r.MaxItemNameChars+"}?)$"),t.parserRegExpOfficial=new RegExp("^［料理］.*?\\((\\d+)\\) の所持する ItemNo.(\\d+)（.*?）から ("+P.Categories.Names.join("|")+") を作製　　└〈料理名〉(.{1,"+r.MaxItemNameChars+"}?)$"),t}(h),v=function(){function i(){this.forms=[],this.$seisanpastaBox=[],this.BindEventsAndExtractForms(),i.InsertInfoBarAndStyle()}return i.prototype.BindEventsAndExtractForms=function(){var e=this;a("input[name^='dt_seieno']").on("paste",function(t){return e.ENoInputOnPasting(t)}),a("input[name^='dt_seieno']").add("input[name^='dt_sakuA']").add("input[name^='dt_sakuC']").add("input[name^='dt_hukaA']").add("input[name^='dt_hukaB']").add("input[name^='dt_goseiA']").add("input[name^='dt_goseiB']").add("input[name^='dt_ryoriA']").add("input[name^='dt_ryoriC']").keyup(function(t){return i.TriggerUpdatingEvent(t)}),a("select[name^='dt_sakuB']").add("select[name^='dt_sakuD']").add("select[name^='dt_goseiC']").add("select[name^='dt_ryoriB']").change(function(t){return i.TriggerUpdatingEvent(t)}),a("select[name^='dt_seisan']").change(function(t){return e.ProductionTypeOnChange(t)}).trigger("change")},i.TriggerUpdatingEvent=function(t){u("triggering updating event"),a(t.target).trigger(i.FormUpdatingEventName)},i.prototype.UpdatingEvent=function(e){try{e.ImportProduction()}catch(t){return void this.ProcessAndShowUniqueErrors(e.ProductionNumber,t)}u("Processing "+i.FormUpdatingEventName+" Event...",e),this.UpdatePastaBox(e)},i.prototype.ProcessAndShowUniqueErrors=function(t,e){var n;if("InvalidENoError"===e.name)n="入力されたENo.が不正です。(入力値: "+e.ENoText+")";else if("InvalidItemNumberError"===e.name)n="入力されたItemNo.が不正です。(入力値: "+e.ItemNumberText+")";else{if("ItemNameTooLongError"!==e.name)throw"ProductionTypeIsNotSetError"===e.name&&(n="重大なエラーが発生しました。 #ProductionTypeIsNotSetError"),e;n="入力されたアイテム名が長すぎます。("+e.ItemName.length+"文字)"}this.ShowError(t,n)},i.prototype.ProductionTypeOnChange=function(t){var e=this,n=m.ExtractProductionNumber(t.target),r=this.forms[n];r&&r.Unbind(i.FormUpdatingEventName);var o=i.BuildEmptyForm(n);u("current: ",r,", new: ",o),(this.forms[n]=o)?(o.Bind(i.FormUpdatingEventName,function(t){return e.UpdatingEvent(t)}),this.UpdatingEvent(o)):this.HidePastaBox(n)},i.prototype.UpdatePastaBox=function(t,e){var n;"number"==typeof t?n=t:(n=t.ProductionNumber,e=t.Production?t.Production.GeneratePasta():"");var r=this.$seisanpastaBox[n];u("Updating pasta box...",e,r),e?r?r.html(e).show():this.$seisanpastaBox[n]=a('<div id="Seisanpasta'+n+'" class="P2">'+e+"</div>").insertBefore("#SAKUSEI"+n):this.HidePastaBox(n)},i.prototype.ShowError=function(t,e){if(!e)throw new o("エラーメッセージが指定されていません。");this.UpdatePastaBox(t,'<b class="R2">'+e+"</b>")},i.prototype.HidePastaBox=function(t){var e=this.$seisanpastaBox[t];e&&e.hide()},i.prototype.ENoInputOnPasting=function(t){var e=t.originalEvent.clipboardData.getData("text/plain"),n=e.replace(/[\r\n]/g,"");if(u("on paste;",e,n),null===s(n)&&(t.preventDefault(),""!==n)){var r,o=m.ExtractProductionNumber(t.target);try{r=i.NewFormFromPasta(o,n)}catch(t){if("InvalidPastaError"===t.name)return void window.alert("貼り付けられた次のテキストはパスタとして認識されませんでした。: \n"+e);throw t}r.ExportProduction(),a("select[name='dt_seisan"+o+"']").trigger("change")}},i.BuildEmptyForm=function(t){var e=m.ExtractProductionType(t);switch(e){case p.None:return null;case p.Equipment:return new N(t);case p.Enchantment:return new f(t);case p.Composition:return new y(t);case p.Food:return new P(t);default:throw new o("生産種を正常に取得できませんでした。("+e+")")}},i.NewFormFromPasta=function(t,e){var n=I.TryParse(t,e)||g.TryParse(t,e)||E.TryParse(t,e)||_.TryParse(t,e);if(!n)throw new x(e);switch(n.ProductionType){case p.Equipment:return new N(t,n);case p.Enchantment:return new f(t,n);case p.Composition:return new y(t,n);case p.Food:return new P(t,n);default:throw new o("")}},i.InsertInfoBarAndStyle=function(){var t;a(".G3:contains(各種生産行動)").nextUntil("br").after('<div id="ISP_Info" class="Y2">Ibara Seisan Pasta v1.1.3 <a id="ISP_HelpLink" class="R2">[HELP]</a><div id="ISP_HelpBody" class="W2"><b>Ibara Seisan Pastaは他者への生産仕様の伝達や、仕様からの生産入力を補助する目的で作られました。</b>\n<span class="P2">ここではこのツールに適合する生産仕様テキストのことを<b class="Y2">パスタ</b>と呼びます。</span>\n\n<b class="R2">«パスタの出力（生成）»</b>\n各生産に必要な情報をすべて正しく入力すると、パスタが自動的に生成され表示されます。\nパスタは生産内容の確認や他プレイヤーへの生産内容伝達に使用できます。\n\n<b class="R2">«パスタの入力»</b>\n<b>ENo.入力欄</b>に有効なパスタを<b>貼り付け</b>すると、その内容から生産を自動入力します。\n\n<b class="Y2">【有効なパスタの例】</b>各1行がそれぞれ1つのパスタを表します。\n<span class="P2">-作製</span>\n[装備作製]ENo.6789/ItemNo.1/防具/ころも/武器なら射程3\n[作製]ENo.6789/ItemNo.1/武器/こんぼう/射程1\n[作製]ENo.6789/ItemNo.1/防具/ころも\n6789/1/装飾/ゆびわ\n\n<span class="P2">-付加</span>\n[効果付加]ENo.6789/ItemNo.1/ItemNo.2\n[付加]6789/1/2\n6789/1/2/付加\n\n<span class="P2">-合成</span>\n[合成]ENo.6789/ItemNo.1/ItemNo.2/合成実験\n[合成]ENo.6789/ItemNo.1/ItemNo.2\n[合成]6789/1/2\n6789/1/2/合成\n\n<span class="P2">-料理</span>\n[料理]ENo.6789/ItemNo.1/料理/たまごやき\n6789/1/料理/たまごやき</span>\n\nまた、これらに加えて<b>【▼最新の送信内容をざっくり確認】のコピーをパスタとして自動入力が行えます。</b>\n（武器や料理などアイテム名を指定する生産の場合には複数行の貼り付けが必要です。）</div></div>'),t='#ISP_Info {\n    display: inline-block;\n    width: 400px;\n    text-align: right;\n    position: relative;\n}\n#ISP_HelpBody {\n    display: none;\n    width: 640px;\n    text-align: left;\n    white-space: pre-wrap;\n    background-color: rgba(51, 2, 18, 0.95);\n    padding: 10px;\n    position: absolute;\n    right: 0;\n}\n#ISP_HelpLink:hover + #ISP_HelpBody, #ISP_HelpBody:hover {\n    display: block;\n}\ninput[name^="dt_seieno"] {\n    background-color: blanchedalmond;\n    border: double gray;\n}',a('<style type="text/css"/>').append(t).appendTo("head")},i.FormUpdatingEventName="ISP_formUpdated",i}(),x=function(r){function t(t,e){var n=r.call(this,e)||this;return n.Pasta=t,n.name="InvalidPastaError",n}return __extends(t,r),t}(o);new v}(Program||(Program={}));